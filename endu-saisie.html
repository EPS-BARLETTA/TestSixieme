<!DOCTYPE html><html lang="fr"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Endurance — Saisie</title>
<style>
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,sans-serif;background:#f8fafc;color:#0b1324}
  .wrap{max-width:980px;margin:0 auto;padding:18px}
  h1{margin:0 0 12px}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:900px){ .grid{grid-template-columns:1fr 1fr} }
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px;box-shadow:0 10px 26px rgba(0,0,0,.06)}
  label{display:block;margin:8px 0 6px}
  input,select,button{padding:12px 14px;border-radius:12px;border:1px solid #e5e7eb;font-weight:600}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .ok{background:#22c55e;color:#fff;border:none}
  .back{background:#3b82f6;color:#fff;border:none}
  .note{font-size:14px;color:#475569}
</style>
</head>
<body><div class="wrap">
  <h1>Saisie Endurance (Luc Léger)</h1>
  <div class="grid">
    <form class="card" id="f1">
      <h3>Élève 1</h3>
      <label>Palier</label><input type="number" id="p1" min="1" max="21" required>
      <label>Navette</label><input type="number" id="n1" min="1" max="20" required>
      <div class="note">VMA estimée : <span id="v1">—</span> km/h</div>
      <div class="row"><button class="ok" type="submit">Enregistrer E1</button></div>
    </form>
    <form class="card" id="f2">
      <h3>Élève 2</h3>
      <label>Palier</label><input type="number" id="p2" min="1" max="21" required>
      <label>Navette</label><input type="number" id="n2" min="1" max="20" required>
      <div class="note">VMA estimée : <span id="v2">—</span> km/h</div>
      <div class="row"><button class="ok" type="submit">Enregistrer E2</button></div>
    </form>
  </div>
  <div class="row" style="margin-top:14px">
    <button class="back" onclick="location.href='menu.html'">⬅︎ Retour au menu</button>
  </div>
</div>
<script>
const KEY='ts6e.duo';
function ensure(){let d; try{d=JSON.parse(localStorage.getItem(KEY)||'null')}catch{d=null}
  if(!d){d={eleves:[{Nom:'',Prenom:'',Classe:'',Sexe:''},{Nom:'',Prenom:'',Classe:'',Sexe:''}],tests:{Endurance:[null,null],Saut:[null,null],Vitesse:[null,null]}}; localStorage.setItem(KEY,JSON.stringify(d));}
  return JSON.parse(localStorage.getItem(KEY));
}
function save(d){ localStorage.setItem(KEY, JSON.stringify(d)); }
// VMA from palier (approx): 8 + 0.5 * palier
const vma = p => +(8 + 0.5*Number(p)).toFixed(1);

function saveE(i, p, n){
  const d = ensure();
  const rec = { Palier:Number(p), Navette:Number(n), VMA:vma(p) };
  d.tests.Endurance[i] = rec;
  save(d);
  alert('Endurance E'+(i+1)+' enregistrée : Palier '+p+' / Navette '+n+' (VMA '+rec.VMA+' km/h)');
}

function bind(fid, pid, nid, vid, idx){
  const f = document.getElementById(fid);
  const p = document.getElementById(pid);
  const n = document.getElementById(nid);
  const v = document.getElementById(vid);
  function upd(){ v.textContent = isFinite(Number(p.value)) ? vma(p.value).toFixed(1) : '—'; }
  p.addEventListener('input', upd); upd();
  f.addEventListener('submit', e=>{
    e.preventDefault();
    if(!p.value || !n.value){ alert('Renseigne Palier et Navette.'); return; }
    saveE(idx, p.value, n.value);
  });
}
bind('f1','p1','n1','v1',0);
bind('f2','p2','n2','v2',1);
</script>
<script src="ui-autoinject.js"></script>
</body></html>
